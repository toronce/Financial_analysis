<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>ì¬ë¬´ì œí‘œ ë¶„ì„ê¸°</title>
    
    <!-- CSS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- JavaScript ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <style>
        .hidden { display: none !important; }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .ratio-card {
            transition: all 0.3s ease;
        }
        .ratio-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 768px) {
            .grid-cols-3 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
            .text-3xl { font-size: 1.5rem; }
            .p-8 { padding: 1rem; }
        }
        
        /* PWA ì§€ì› */
        .pwa-install {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <!-- PWA ì„¤ì¹˜ ë²„íŠ¼ -->
    <button id="installBtn" class="pwa-install hidden bg-blue-600 text-white p-3 rounded-full shadow-lg">
        <i class="fas fa-download"></i>
    </button>

    <div class="container mx-auto p-4 max-w-7xl">
        <!-- í—¤ë” -->
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">
                <i class="fas fa-chart-line text-blue-600 mr-2"></i>
                ì¬ë¬´ì œí‘œ ë¶„ì„ê¸°
            </h1>
            <p class="text-gray-600">Excel, CSV íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ìë™ìœ¼ë¡œ ì¬ë¬´ ë¶„ì„ì„ ë°›ì•„ë³´ì„¸ìš”</p>
            <div class="mt-2 text-sm text-gray-500">
                ğŸ“± ëª¨ë°”ì¼ ìµœì í™” | ğŸ” ì‹¤ì‹œê°„ ë¶„ì„ | ğŸ“Š ì°¨íŠ¸ ì§€ì›
            </div>
        </header>

        <!-- íƒ­ ë©”ë‰´ -->
        <div class="flex flex-wrap bg-white rounded-lg shadow-md mb-6 overflow-hidden">
            <button onclick="showTab('upload')" id="tab-upload" 
                    class="flex-1 min-w-0 py-3 px-4 text-sm font-medium bg-blue-600 text-white border-r border-gray-200 transition-colors">
                <i class="fas fa-upload mr-1"></i>
                <span class="hidden sm:inline">íŒŒì¼ </span>ì—…ë¡œë“œ
            </button>
            <button onclick="showTab('data')" id="tab-data" 
                    class="flex-1 min-w-0 py-3 px-4 text-sm font-medium text-gray-600 hover:bg-gray-50 border-r border-gray-200 transition-colors">
                <i class="fas fa-table mr-1"></i>
                <span class="hidden sm:inline">ë°ì´í„° </span>í™•ì¸
            </button>
            <button onclick="showTab('analysis')" id="tab-analysis" 
                    class="flex-1 min-w-0 py-3 px-4 text-sm font-medium text-gray-600 hover:bg-gray-50 border-r border-gray-200 transition-colors">
                <i class="fas fa-calculator mr-1"></i>
                <span class="hidden sm:inline">ì¬ë¬´ </span>ë¶„ì„
            </button>
            <button onclick="showTab('charts')" id="tab-charts" 
                    class="flex-1 min-w-0 py-3 px-4 text-sm font-medium text-gray-600 hover:bg-gray-50 transition-colors">
                <i class="fas fa-chart-bar mr-1"></i>
                <span class="hidden sm:inline">ì°¨íŠ¸ </span>ë¶„ì„
            </button>
        </div>

        <!-- íŒŒì¼ ì—…ë¡œë“œ íƒ­ -->
        <div id="content-upload" class="bg-white rounded-lg shadow-lg p-8">
            <div class="text-center">
                <div class="text-6xl mb-4">ğŸ“¤</div>
                <h3 class="text-xl font-semibold mb-2">ì¬ë¬´ì œí‘œ íŒŒì¼ ì—…ë¡œë“œ</h3>
                <p class="text-gray-600 mb-6">Excel (.xlsx, .xls) ë˜ëŠ” CSV íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”</p>
                
                <!-- íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ -->
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 mb-6 hover:border-blue-400 transition-colors"
                     ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                    <input type="file" accept=".xlsx,.xls,.csv" onchange="handleFileUpload(event)" 
                           id="file-upload" class="hidden">
                    <label for="file-upload" class="cursor-pointer">
                        <div class="text-gray-500 mb-2">
                            <i class="fas fa-cloud-upload-alt text-3xl mb-2"></i>
                            <p>íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </label>
                    <button onclick="document.getElementById('file-upload').click()" 
                            class="mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-folder-open mr-2"></i>íŒŒì¼ ì„ íƒ
                    </button>
                </div>
                
                <!-- ë¡œë”© -->
                <div id="loading" class="hidden">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
                    <p class="text-gray-600 mt-2">íŒŒì¼ ì²˜ë¦¬ ì¤‘...</p>
                </div>
                
                <!-- ìƒ˜í”Œ ë°ì´í„° ë²„íŠ¼ -->
                <div class="mb-6">
                    <button onclick="loadSampleData()" 
                            class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                        <i class="fas fa-play mr-2"></i>ìƒ˜í”Œ ë°ì´í„°ë¡œ ì²´í—˜í•˜ê¸°
                    </button>
                </div>
                
                <!-- ê°€ì´ë“œ -->
                <div class="grid md:grid-cols-2 gap-6 text-left">
                    <div>
                        <h4 class="font-semibold mb-3 text-blue-800">
                            <i class="fas fa-file-alt mr-2"></i>ì§€ì› íŒŒì¼ í˜•ì‹
                        </h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Excel íŒŒì¼ (.xlsx, .xls)</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>CSV íŒŒì¼ (.csv)</li>
                            <li><i class="fas fa-info-circle text-blue-500 mr-2"></i>ìµœëŒ€ íŒŒì¼ í¬ê¸°: 10MB</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-3 text-green-800">
                            <i class="fas fa-database mr-2"></i>ì˜ˆìƒ ë°ì´í„° êµ¬ì¡°
                        </h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li><strong>ì—°ë„</strong>: ë¶„ì„í•  ì—°ë„</li>
                            <li><strong>ë§¤ì¶œì•¡</strong>: íšŒì‚¬ê°€ íŒë§¤í•´ì„œ ë²ˆ ì´ ê¸ˆì•¡</li>
                            <li><strong>ì˜ì—…ì´ìµ</strong>: ë³¸ì—…ì—ì„œ ë²ˆ ì´ìµ</li>
                            <li><strong>ìˆœì´ìµ</strong>: ìµœì¢… ì´ìµ</li>
                            <li><strong>ì´ìì‚°</strong>: íšŒì‚¬ê°€ ê°€ì§„ ëª¨ë“  ì¬ì‚°</li>
                            <li><strong>ë¶€ì±„</strong>: ê°šì•„ì•¼ í•  ë¹š</li>
                            <li><strong>ìë³¸</strong>: ì£¼ì£¼ íˆ¬ìê¸ˆ + ì´ìµ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ë°ì´í„° í™•ì¸ íƒ­ -->
        <div id="content-data" class="hidden bg-white rounded-lg shadow-lg p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">
                    <i class="fas fa-table text-blue-600 mr-2"></i>ì—…ë¡œë“œëœ ë°ì´í„°
                </h3>
                <button onclick="exportData()" id="exportBtn" class="hidden px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                    <i class="fas fa-download mr-2"></i>Excelë¡œ ë‚´ë³´ë‚´ê¸°
                </button>
            </div>
            <div id="data-table" class="overflow-x-auto">
                <div class="text-center py-12 text-gray-500">
                    <i class="fas fa-inbox text-4xl mb-4"></i>
                    <p>íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <!-- ì¬ë¬´ ë¶„ì„ íƒ­ -->
        <div id="content-analysis" class="hidden space-y-6">
            <!-- ìš”ì•½ ì¹´ë“œ -->
            <div id="summary-card" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg p-6 hidden">
                <h3 class="text-xl font-semibold mb-4">ğŸ“Š ì¢…í•© ë¶„ì„ ìš”ì•½</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="summary-content">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>

            <!-- ìˆ˜ìµì„± ë¶„ì„ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4">
                    <i class="fas fa-chart-line text-green-600 mr-2"></i>ìˆ˜ìµì„± ë¶„ì„
                </h3>
                <div class="bg-blue-50 p-4 rounded-lg mb-6">
                    <h4 class="font-semibold text-blue-800 mb-2">ğŸ’¡ ìˆ˜ìµì„±ì´ë€?</h4>
                    <p class="text-blue-700 text-sm">
                        ê¸°ì—…ì´ ì–¼ë§ˆë‚˜ íš¨ìœ¨ì ìœ¼ë¡œ ëˆì„ ë²Œê³  ìˆëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ì§€í‘œì…ë‹ˆë‹¤. 
                        ê°™ì€ ë§¤ì¶œì´ë¼ë„ ë¹„ìš©ì„ ì ê²Œ ì“°ê³  ë” ë§ì€ ì´ìµì„ ë‚´ëŠ” íšŒì‚¬ê°€ ìˆ˜ìµì„±ì´ ì¢‹ì€ íšŒì‚¬ì…ë‹ˆë‹¤.
                    </p>
                </div>
                <div id="profitability-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>

            <!-- ìœ ë™ì„± ë¶„ì„ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4">
                    <i class="fas fa-tint text-blue-600 mr-2"></i>ìœ ë™ì„± ë¶„ì„
                </h3>
                <div class="bg-green-50 p-4 rounded-lg mb-6">
                    <h4 class="font-semibold text-green-800 mb-2">ğŸ’° ìœ ë™ì„±ì´ë€?</h4>
                    <p class="text-green-700 text-sm">
                        íšŒì‚¬ê°€ ë‹¨ê¸°ê°„ì— í˜„ê¸ˆì„ ë§ˆë ¨í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì…ë‹ˆë‹¤. 
                        ê¸‰í•˜ê²Œ ëˆì´ í•„ìš”í•  ë•Œ ìì‚°ì„ í˜„ê¸ˆìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆëŠ”ì§€, ë¹šì„ ê°šì„ ìˆ˜ ìˆëŠ”ì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    </p>
                </div>
                <div id="liquidity-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>

            <!-- ì•ˆì •ì„± ë¶„ì„ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4">
                    <i class="fas fa-shield-alt text-purple-600 mr-2"></i>ì•ˆì •ì„± ë¶„ì„
                </h3>
                <div class="bg-purple-50 p-4 rounded-lg mb-6">
                    <h4 class="font-semibold text-purple-800 mb-2">ğŸ›¡ï¸ ì•ˆì •ì„±ì´ë€?</h4>
                    <p class="text-purple-700 text-sm">
                        íšŒì‚¬ê°€ ë¹šì— ì˜ì¡´í•˜ì§€ ì•Šê³  ì•ˆì „í•˜ê²Œ ìš´ì˜ë˜ê³  ìˆëŠ”ì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. 
                        ë¹šì´ ë„ˆë¬´ ë§ìœ¼ë©´ ì´ì ë¶€ë‹´ì´ ì»¤ì ¸ì„œ ìœ„í—˜í•  ìˆ˜ ìˆì–´ìš”.
                    </p>
                </div>
                <div id="stability-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>
        </div>

        <!-- ì°¨íŠ¸ ë¶„ì„ íƒ­ -->
        <div id="content-charts" class="hidden space-y-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4">
                    <i class="fas fa-chart-area text-indigo-600 mr-2"></i>ì¬ë¬´ ì¶”ì„¸ ë¶„ì„
                </h3>
                <div class="relative" style="height: 400px;">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">
                        <i class="fas fa-percentage text-green-600 mr-2"></i>ìˆ˜ìµì„± ì§€í‘œ
                    </h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="profitChart"></canvas>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">
                        <i class="fas fa-balance-scale text-blue-600 mr-2"></i>ì•ˆì •ì„± ì§€í‘œ
                    </h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="stabilityChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- í‘¸í„° -->
    <footer class="bg-white border-t mt-12 py-6">
        <div class="container mx-auto px-4 text-center text-gray-600">
            <p class="mb-2">
                <i class="fas fa-chart-line text-blue-600 mr-2"></i>
                ì¬ë¬´ì œí‘œ ë¶„ì„ê¸° - ë¬´ë£Œ ì¬ë¬´ ë¶„ì„ ë„êµ¬
            </p>
            <p class="text-sm">
                GitHub Pagesë¡œ ì œê³µ | 
                <a href="https://github.com" target="_blank" class="text-blue-600 hover:underline">
                    <i class="fab fa-github mr-1"></i>ì†ŒìŠ¤ì½”ë“œ
                </a>
            </p>
        </div>
    </footer>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let uploadedData = null;
        let analysisData = null;
        let charts = {};

        // PWA ì„¤ì¹˜ ì§€ì›
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            deferredPrompt = e;
            document.getElementById('installBtn').classList.remove('hidden');
        });

        document.getElementById('installBtn').addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                document.getElementById('installBtn').classList.add('hidden');
            }
        });

        // íƒ­ ì „í™˜ ê¸°ëŠ¥
        function showTab(tabName) {
            const tabs = ['upload', 'data', 'analysis', 'charts'];
            
            tabs.forEach(tab => {
                const tabBtn = document.getElementById(`tab-${tab}`);
                const content = document.getElementById(`content-${tab}`);
                
                if (tab === tabName) {
                    tabBtn.className = 'flex-1 min-w-0 py-3 px-4 text-sm font-medium bg-blue-600 text-white border-r border-gray-200 transition-colors';
                    content.classList.remove('hidden');
                } else {
                    tabBtn.className = 'flex-1 min-w-0 py-3 px-4 text-sm font-medium text-gray-600 hover:bg-gray-50 border-r border-gray-200 transition-colors';
                    content.classList.add('hidden');
                }
            });
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('border-blue-400', 'bg-blue-50');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('border-blue-400', 'bg-blue-50');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('border-blue-400', 'bg-blue-50');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                processFile(file);
            }
        }

        // íŒŒì¼ ì²˜ë¦¬ í•¨ìˆ˜
        async function processFile(file) {
            // íŒŒì¼ í¬ê¸° ì²´í¬ (10MB)
            if (file.size > 10 * 1024 * 1024) {
                alert('íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. 10MB ì´í•˜ì˜ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading(true);

            try {
                let parsedData;

                if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                    const arrayBuffer = await file.arrayBuffer();
                    const workbook = XLSX.read(arrayBuffer);
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    parsedData = XLSX.utils.sheet_to_json(worksheet);
                } else if (file.name.endsWith('.csv')) {
                    const text = await file.text();
                    const result = Papa.parse(text, { 
                        header: true, 
                        dynamicTyping: true,
                        skipEmptyLines: true
                    });
                    parsedData = result.data;
                } else {
                    throw new Error('ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. Excel ë˜ëŠ” CSV íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                }

                if (!parsedData || parsedData.length === 0) {
                    throw new Error('íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                }

                uploadedData = parsedData;
                displayData(parsedData);
                analyzeData(parsedData);
                
                // ë¶„ì„ íƒ­ìœ¼ë¡œ ì´ë™
                showTab('analysis');
                
                alert(`âœ… íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ!\nğŸ“Š ${parsedData.length}ê°œ í–‰ì˜ ë°ì´í„°ë¥¼ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.`);
                
            } catch (error) {
                console.error('íŒŒì¼ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                alert('âŒ ' + error.message);
            }

            showLoading(false);
        }

        // ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ
        function loadSampleData() {
            const sampleData = [
                { ì—°ë„: 2021, ë§¤ì¶œì•¡: 1000, ì˜ì—…ì´ìµ: 150, ìˆœì´ìµ: 120, ì´ìì‚°: 1500, ë¶€ì±„: 600, ìë³¸: 900, í˜„ê¸ˆ: 200, ìœ ë™ìì‚°: 500, ìœ ë™ë¶€ì±„: 300 },
                { ì—°ë„: 2022, ë§¤ì¶œì•¡: 1200, ì˜ì—…ì´ìµ: 180, ìˆœì´ìµ: 140, ì´ìì‚°: 1700, ë¶€ì±„: 650, ìë³¸: 1050, í˜„ê¸ˆ: 250, ìœ ë™ìì‚°: 600, ìœ ë™ë¶€ì±„: 320 },
                { ì—°ë„: 2023, ë§¤ì¶œì•¡: 1400, ì˜ì—…ì´ìµ: 210, ìˆœì´ìµ: 170, ì´ìì‚°: 1900, ë¶€ì±„: 700, ìë³¸: 1200, í˜„ê¸ˆ: 300, ìœ ë™ìì‚°: 700, ìœ ë™ë¶€ì±„: 350 },
                { ì—°ë„: 2024, ë§¤ì¶œì•¡: 1600, ì˜ì—…ì´ìµ: 240, ìˆœì´ìµ: 200, ì´ìì‚°: 2100, ë¶€ì±„: 750, ìë³¸: 1350, í˜„ê¸ˆ: 350, ìœ ë™ìì‚°: 800, ìœ ë™ë¶€ì±„: 380 }
            ];

            uploadedData = sampleData;
            displayData(sampleData);
            analyzeData(sampleData);
            showTab('analysis');
            
            alert('ğŸ“Š ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤!\nì´ì œ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.');
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading(show) {
            const loading = document.getElementById('loading');
            if (show) {
                loading.classList.remove('hidden');
            } else {
                loading.classList.add('hidden');
            }
        }

        // ë°ì´í„° í‘œì‹œ
        function displayData(data) {
            if (!data || data.length === 0) return;

            const headers = Object.keys(data[0]);
            let tableHtml = `
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
            `;

            headers.forEach(header => {
                tableHtml += `<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">${header}</th>`;
            });

            tableHtml += `
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
            `;

            data.slice(0, 20).forEach((row, idx) => {
                tableHtml += `<tr class="${idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">`;
                headers.forEach(header => {
                    const value = row[header];
                    const displayValue = typeof value === 'number' ? 
                        value.toLocaleString() : 
                        (value || '');
                    tableHtml += `<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${displayValue}</td>`;
                });
                tableHtml += `</tr>`;
            });

            tableHtml += `
                        </tbody>
                    </table>
                </div>
            `;

            if (data.length > 20) {
                tableHtml += `<p class="text-gray-600 mt-4 text-center">ì´ ${data.length}ê°œ í–‰ ì¤‘ ì²˜ìŒ 20ê°œ í–‰ì„ í‘œì‹œí•©ë‹ˆë‹¤.</p>`;
            }

            document.getElementById('data-table').innerHTML = tableHtml;
            document.getElementById('exportBtn').classList.remove('hidden');
        }

        // ì¬ë¬´ ë¶„ì„
        function analyzeData(data) {
            if (!data || data.length === 0) return;

            // ìµœì‹  ì—°ë„ ë°ì´í„° ì‚¬ìš©
            const latestData = data[data.length - 1];
            
            // ê¸°ë³¸ê°’ ì„¤ì •
            const revenue = latestData['ë§¤ì¶œì•¡'] || latestData['Revenue'] || 0;
            const operatingProfit = latestData['ì˜ì—…ì´ìµ'] || latestData['Operating Profit'] || 0;
            const netIncome = latestData['ìˆœì´ìµ'] || latestData['Net Income'] || 0;
            const totalAssets = latestData['ì´ìì‚°'] || latestData['Total Assets'] || 0;
            const totalDebt = latestData['ë¶€ì±„'] || latestData['Total Debt'] || 0;
            const equity = latestData['ìë³¸'] || latestData['Equity'] || 0;
            const currentAssets = latestData['ìœ ë™ìì‚°'] || latestData['Current Assets'] || totalAssets * 0.4;
            const currentLiabilities = latestData['ìœ ë™ë¶€ì±„'] || latestData['Current Liabilities'] || totalDebt * 0.6;
            const cash = latestData['í˜„ê¸ˆ'] || latestData['Cash'] || currentAssets * 0.3;

            // ì¬ë¬´ë¹„ìœ¨ ê³„ì‚°
            const analysis = {
                profitability: {
                    grossProfitMargin: revenue > 0 ? ((revenue - revenue * 0.6) / revenue * 100) : 0,
                    operatingMargin: revenue > 0 ? (operatingProfit / revenue * 100) : 0,
                    netProfitMargin: revenue > 0 ? (netIncome / revenue * 100) : 0,
                    roe: equity > 0 ? (netIncome / equity * 100) : 0,
                    roa: totalAssets > 0 ? (netIncome / totalAssets * 100) : 0
                },
                liquidity: {
                    currentRatio: currentLiabilities > 0 ? (currentAssets / currentLiabilities) : 0,
                    quickRatio: currentLiabilities > 0 ? ((currentAssets - currentAssets * 0.3) / currentLiabilities) : 0,
                    cashRatio: currentLiabilities > 0 ? (cash / currentLiabilities) : 0
                },
                stability: {
                    debtToEquity: equity > 0 ? (totalDebt / equity) : 0,
                    debtToAssets: totalAssets > 0 ? (totalDebt / totalAssets) : 0,
                    interestCoverage: operatingProfit > 0 ? (operatingProfit / (totalDebt * 0.05)) : 0
                },
                trends: data.map(row => ({
                    year: row['ì—°ë„'] || row['Year'] || '',
                    revenue: row['ë§¤ì¶œì•¡'] || row['Revenue'] || 0,
                    profit: row['ìˆœì´ìµ'] || row['Net Income'] || 0,
                    assets: row['ì´ìì‚°'] || row['Total Assets'] || 0
                }))
            };

            analysisData = analysis;
            displayAnalysis(analysis);
            createCharts(analysis);
        }

        // ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        function displayAnalysis(analysis) {
            displaySummary(analysis);
            displayRatioCards('profitability-cards', [
                { title: 'ë§¤ì¶œì´ì´ìµë¥ ', value: analysis.profitability.grossProfitMargin, unit: '%', good: 25, excellent: 40, description: 'ë§¤ì¶œì—ì„œ ì›ê°€ë¥¼ ëº€ ì´ìµì˜ ë¹„ìœ¨. ë†’ì„ìˆ˜ë¡ ìƒí’ˆ/ì„œë¹„ìŠ¤ì˜ ê²½ìŸë ¥ì´ ì¢‹ìŒ' },
                { title: 'ì˜ì—…ì´ìµë¥ ', value: analysis.profitability.operatingMargin, unit: '%', good: 10, excellent: 20, description: 'ë³¸ì—…ì—ì„œ ì–¼ë§ˆë‚˜ ì´ìµì„ ë‚´ëŠ”ì§€ ë³´ì—¬ì¤Œ. íšŒì‚¬ì˜ í•µì‹¬ ì‚¬ì—… ê²½ìŸë ¥ì„ ë‚˜íƒ€ëƒ„' },
                { title: 'ìˆœì´ìµë¥ ', value: analysis.profitability.netProfitMargin, unit: '%', good: 8, excellent: 15, description: 'ëª¨ë“  ë¹„ìš©ì„ ë¹¼ê³  ë‚¨ì€ ìµœì¢… ì´ìµë¥ . ì‹¤ì œë¡œ ì£¼ì£¼ì—ê²Œ ëŒì•„ê°€ëŠ” ì´ìµ' },
                { title: 'ROE (ìê¸°ìë³¸ì´ìµë¥ )', value: analysis.profitability.roe, unit: '%', good: 12, excellent: 20, description: 'ì£¼ì£¼ê°€ íˆ¬ìí•œ ëˆìœ¼ë¡œ ì–¼ë§ˆë‚˜ ì´ìµì„ ëƒˆëŠ”ì§€. íˆ¬ì íš¨ìœ¨ì„±ì„ ë³´ì—¬ì¤Œ' },
                { title: 'ROA (ì´ìì‚°ì´ìµë¥ )', value: analysis.profitability.roa, unit: '%', good: 6, excellent: 12, description: 'íšŒì‚¬ê°€ ê°€ì§„ ëª¨ë“  ìì‚°ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ì´ìµì„ ëƒˆëŠ”ì§€. ìì‚° í™œìš© íš¨ìœ¨ì„±' }
            ]);

            displayRatioCards('liquidity-cards', [
                { title: 'ìœ ë™ë¹„ìœ¨', value: analysis.liquidity.currentRatio, unit: '', good: 1.5, excellent: 2.0, description: '1ë…„ ë‚´ í˜„ê¸ˆí™” ê°€ëŠ¥í•œ ìì‚° vs 1ë…„ ë‚´ ê°šì•„ì•¼ í•  ë¹š. 2.0 ì´ìƒì´ë©´ ì•ˆì „' },
                { title: 'ë‹¹ì¢Œë¹„ìœ¨', value: analysis.liquidity.quickRatio, unit: '', good: 1.0, excellent: 1.5, description: 'ì¦‰ì‹œ í˜„ê¸ˆí™” ê°€ëŠ¥í•œ ìì‚° vs ë‹¨ê¸° ë¹š. ì¬ê³  ë“±ì„ ì œì™¸í•œ ì§„ì§œ í˜„ê¸ˆí™” ëŠ¥ë ¥' },
                { title: 'í˜„ê¸ˆë¹„ìœ¨', value: analysis.liquidity.cashRatio, unit: '', good: 0.5, excellent: 1.0, description: 'í˜„ê¸ˆê³¼ ì˜ˆê¸ˆ vs ë‹¨ê¸° ë¹š. ê°€ì¥ ë³´ìˆ˜ì ì¸ ì§€í‘œë¡œ ì¦‰ì‹œ ì§€ê¸‰ ëŠ¥ë ¥ì„ ë³´ì—¬ì¤Œ' }
            ]);

            displayRatioCards('stability-cards', [
                { title: 'ë¶€ì±„ë¹„ìœ¨', value: analysis.stability.debtToEquity, unit: '', good: 0.5, excellent: 0.3, description: 'ë¹š vs ìê¸° ëˆì˜ ë¹„ìœ¨. ë‚®ì„ìˆ˜ë¡ ì•ˆì „. 1.0 ì´í•˜ë©´ ë¹šë³´ë‹¤ ìê¸° ëˆì´ ë§ìŒ' },
                { title: 'ë¶€ì±„ìì‚°ë¹„ìœ¨', value: analysis.stability.debtToAssets, unit: '', good: 0.4, excellent: 0.2, description: 'ì „ì²´ ìì‚° ì¤‘ ë¹šì˜ ë¹„ìœ¨. 50% ì´í•˜ë©´ ì•ˆì „í•œ ìˆ˜ì¤€' },
                { title: 'ì´ìë³´ìƒë°°ìœ¨', value: analysis.stability.interestCoverage, unit: 'ë°°', good: 5, excellent: 10, description: 'ì˜ì—…ì´ìµìœ¼ë¡œ ì´ìë¥¼ ëª‡ ë²ˆ ê°šì„ ìˆ˜ ìˆëŠ”ì§€. ë†’ì„ìˆ˜ë¡ ì´ì ì§€ê¸‰ì´ ì•ˆì „' }
            ]);
        }

        // ì¢…í•© ìš”ì•½ í‘œì‹œ
        function displaySummary(analysis) {
            const summaryCard = document.getElementById('summary-card');
            const summaryContent = document.getElementById('summary-content');
            
            // ì¢…í•© ì ìˆ˜ ê³„ì‚°
            const profitScore = calculateScore(analysis.profitability.netProfitMargin, 8, 15);
            const liquidityScore = calculateScore(analysis.liquidity.currentRatio, 1.5, 2.0);
            const stabilityScore = calculateScore(1 - analysis.stability.debtToAssets, 0.6, 0.8);
            
            const overallScore = Math.round((profitScore + liquidityScore + stabilityScore) / 3);
            
            summaryContent.innerHTML = `
                <div class="text-center">
                    <div class="text-3xl font-bold mb-2">${overallScore}/100</div>
                    <div class="text-sm opacity-90">ì¢…í•© ì ìˆ˜</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold mb-2">${getGrade(overallScore)}</div>
                    <div class="text-sm opacity-90">ì¬ë¬´ ë“±ê¸‰</div>
                </div>
                <div class="text-center">
                    <div class="text-xl font-bold mb-2">${analysis.profitability.netProfitMargin.toFixed(1)}%</div>
                    <div class="text-sm opacity-90">ìˆœì´ìµë¥ </div>
                </div>
            `;
            
            summaryCard.classList.remove('hidden');
        }

        // ì ìˆ˜ ê³„ì‚° í•¨ìˆ˜
        function calculateScore(value, good, excellent) {
            if (value >= excellent) return 100;
            if (value >= good) return 70 + (value - good) / (excellent - good) * 30;
            if (value >= 0) return value / good * 70;
            return 0;
        }

        // ë“±ê¸‰ ê³„ì‚° í•¨ìˆ˜
        function getGrade(score) {
            if (score >= 90) return 'A+';
            if (score >= 80) return 'A';
            if (score >= 70) return 'B+';
            if (score >= 60) return 'B';
            if (score >= 50) return 'C+';
            if (score >= 40) return 'C';
            return 'D';
        }

        // ë¹„ìœ¨ ì¹´ë“œ í‘œì‹œ
        function displayRatioCards(containerId, ratios) {
            const container = document.getElementById(containerId);
            let html = '';

            ratios.forEach(ratio => {
                const status = getRatioStatus(ratio.value, ratio.good, ratio.excellent);
                const displayValue = typeof ratio.value === 'number' ? ratio.value.toFixed(1) : '0.0';
                
                html += `
                    <div class="ratio-card bg-white p-4 rounded-lg shadow-md border-l-4 ${status.borderColor}">
                        <div class="flex items-center justify-between mb-2">
                            <h4 class="font-medium text-gray-700 text-sm">${ratio.title}</h4>
                            <i class="fas ${status.icon} ${status.color}"></i>
                        </div>
                        <div class="flex items-end gap-1 mb-2">
                            <span class="text-2xl font-bold ${status.color}">${displayValue}</span>
                            <span class="text-sm text-gray-500">${ratio.unit}</span>
                        </div>
                        <p class="text-xs text-gray-500 leading-tight">${ratio.description}</p>
                        <div class="mt-2">
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="${status.bgColor} h-2 rounded-full transition-all duration-500" 
                                     style="width: ${Math.min(100, (ratio.value / ratio.excellent) * 100)}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // ë¹„ìœ¨ ìƒíƒœ ê³„ì‚°
        function getRatioStatus(value, good, excellent) {
            if (value >= excellent) {
                return {
                    status: 'excellent',
                    color: 'text-green-600',
                    icon: 'fa-arrow-up',
                    borderColor: 'border-l-green-500',
                    bgColor: 'bg-green-500'
                };
            } else if (value >= good) {
                return {
                    status: 'good',
                    color: 'text-blue-600',
                    icon: 'fa-arrow-up',
                    borderColor: 'border-l-blue-500',
                    bgColor: 'bg-blue-500'
                };
            } else {
                return {
                    status: 'warning',
                    color: 'text-red-600',
                    icon: 'fa-arrow-down',
                    borderColor: 'border-l-red-500',
                    bgColor: 'bg-red-500'
                };
            }
        }

        // ì°¨íŠ¸ ìƒì„±
        function createCharts(analysis) {
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });

            // ì¶”ì„¸ ì°¨íŠ¸
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            charts.trend = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: analysis.trends.map(t => t.year),
                    datasets: [{
                        label: 'ë§¤ì¶œì•¡',
                        data: analysis.trends.map(t => t.revenue),
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'ìˆœì´ìµ',
                        data: analysis.trends.map(t => t.profit),
                        borderColor: 'rgb(16, 185, 129)',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ë§¤ì¶œì•¡ ë° ìˆœì´ìµ ì¶”ì„¸'
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // ìˆ˜ìµì„± ì°¨íŠ¸
            const profitCtx = document.getElementById('profitChart').getContext('2d');
            charts.profit = new Chart(profitCtx, {
                type: 'bar',
                data: {
                    labels: ['ë§¤ì¶œì´ì´ìµë¥ ', 'ì˜ì—…ì´ìµë¥ ', 'ìˆœì´ìµë¥ '],
                    datasets: [{
                        label: 'ìˆ˜ìµì„± (%)',
                        data: [
                            analysis.profitability.grossProfitMargin,
                            analysis.profitability.operatingMargin,
                            analysis.profitability.netProfitMargin
                        ],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(139, 92, 246, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(16, 185, 129)',
                            'rgb(139, 92, 246)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });

            // ì•ˆì •ì„± ì°¨íŠ¸
            const stabilityCtx = document.getElementById('stabilityChart').getContext('2d');
            charts.stability = new Chart(stabilityCtx, {
                type: 'doughnut',
                data: {
                    labels: ['ìœ ë™ë¹„ìœ¨', 'ë‹¹ì¢Œë¹„ìœ¨', 'í˜„ê¸ˆë¹„ìœ¨'],
                    datasets: [{
                        data: [
                            analysis.liquidity.currentRatio,
                            analysis.liquidity.quickRatio,
                            analysis.liquidity.cashRatio
                        ],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(16, 185, 129)',
                            'rgb(245, 158, 11)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        function exportData() {
            if (!uploadedData || !analysisData) {
                alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ë¶„ì„ ê²°ê³¼ë¥¼ í¬í•¨í•œ ì›Œí¬ë¶ ìƒì„±
            const wb = XLSX.utils.book_new();
            
            // ì›ë³¸ ë°ì´í„° ì‹œíŠ¸
            const ws1 = XLSX.utils.json_to_sheet(uploadedData);
            XLSX.utils.book_append_sheet(wb, ws1, 'ì›ë³¸ ë°ì´í„°');
            
            // ë¶„ì„ ê²°ê³¼ ì‹œíŠ¸
            const analysisSheet = [
                { êµ¬ë¶„: 'ìˆ˜ìµì„± ë¶„ì„', ì§€í‘œ: '', ê°’: '', ë‹¨ìœ„: '' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ë§¤ì¶œì´ì´ìµë¥ ', ê°’: analysisData.profitability.grossProfitMargin.toFixed(2), ë‹¨ìœ„: '%' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ì˜ì—…ì´ìµë¥ ', ê°’: analysisData.profitability.operatingMargin.toFixed(2), ë‹¨ìœ„: '%' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ìˆœì´ìµë¥ ', ê°’: analysisData.profitability.netProfitMargin.toFixed(2), ë‹¨ìœ„: '%' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ROE', ê°’: analysisData.profitability.roe.toFixed(2), ë‹¨ìœ„: '%' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ROA', ê°’: analysisData.profitability.roa.toFixed(2), ë‹¨ìœ„: '%' },
                { êµ¬ë¶„: 'ìœ ë™ì„± ë¶„ì„', ì§€í‘œ: '', ê°’: '', ë‹¨ìœ„: '' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ìœ ë™ë¹„ìœ¨', ê°’: analysisData.liquidity.currentRatio.toFixed(2), ë‹¨ìœ„: '' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ë‹¹ì¢Œë¹„ìœ¨', ê°’: analysisData.liquidity.quickRatio.toFixed(2), ë‹¨ìœ„: '' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'í˜„ê¸ˆë¹„ìœ¨', ê°’: analysisData.liquidity.cashRatio.toFixed(2), ë‹¨ìœ„: '' },
                { êµ¬ë¶„: 'ì•ˆì •ì„± ë¶„ì„', ì§€í‘œ: '', ê°’: '', ë‹¨ìœ„: '' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ë¶€ì±„ë¹„ìœ¨', ê°’: analysisData.stability.debtToEquity.toFixed(2), ë‹¨ìœ„: '' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ë¶€ì±„ìì‚°ë¹„ìœ¨', ê°’: analysisData.stability.debtToAssets.toFixed(2), ë‹¨ìœ„: '' },
                { êµ¬ë¶„: '', ì§€í‘œ: 'ì´ìë³´ìƒë°°ìœ¨', ê°’: analysisData.stability.interestCoverage.toFixed(2), ë‹¨ìœ„: 'ë°°' }
            ];
            
            const ws2 = XLSX.utils.json_to_sheet(analysisSheet);
            XLSX.utils.book_append_sheet(wb, ws2, 'ë¶„ì„ ê²°ê³¼');
            
            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            const fileName = `ì¬ë¬´ë¶„ì„_ê²°ê³¼_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            alert('ğŸ“Š ë¶„ì„ ê²°ê³¼ê°€ Excel íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ (PWA)
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js').catch(console.error);
            }
            
            // ì´ˆê¸° íƒ­ ì„¤ì •
            showTab('upload');
            
            // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'u':
                            e.preventDefault();
                            document.getElementById('file-upload').click();
                            break;
                        case 's':
                            e.preventDefault();
                            if (analysisData) exportData();
                            break;
                    }
                }
            });
            
            console.log('ğŸ“Š ì¬ë¬´ì œí‘œ ë¶„ì„ê¸°ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!');
        });

        // ì—ëŸ¬ í•¸ë“¤ë§
        window.addEventListener('error', function(e) {
            console.error('ì• í”Œë¦¬ì¼€ì´ì…˜ ì˜¤ë¥˜:', e.error);
            alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ ì£¼ì„¸ìš”.');
        });

        // ë°˜ì‘í˜• ì²˜ë¦¬
        window.addEventListener('resize', function() {
            Object.values(charts).forEach(chart => {
                if (chart) chart.resize();
            });
        });
    </script>
</body>
</html>
